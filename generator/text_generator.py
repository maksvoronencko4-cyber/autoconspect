"""
–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤
"""

import random
from datetime import datetime


class TextGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —É—á–µ–±–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤"""
    
    def __init__(self):
        self._load_templates()
    
    def _load_templates(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–æ–≤"""
        
        self.introductions = {
            "scientific": [
                "–î–∞–Ω–Ω–∞—è —Ç–µ–º–∞ —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞—É–∫–µ. {topic} –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ª–æ–∂–Ω—ã–π –∏ –º–Ω–æ–≥–æ–≥—Ä–∞–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, —Ç—Ä–µ–±—É—é—â–∏–π –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.",
                "–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑—É—á–µ–Ω–∏—è —Ç–µ–º—ã ¬´{topic}¬ª –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞ –µ—ë –∑–Ω–∞—á–∏–º–æ—Å—Ç—å—é –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ —è–≤–ª–µ–Ω–∏–π.",
                "–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å —Ç–µ–º–æ–π ¬´{topic}¬ª, –∏–º–µ–µ—Ç –≤–∞–∂–Ω–æ–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ."
            ],
            "simple": [
                "–¢–µ–º–∞ ¬´{topic}¬ª –æ—á–µ–Ω—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∏ –≤–∞–∂–Ω–∞—è. –í —ç—Ç–æ–π —Ä–∞–±–æ—Ç–µ –º—ã —Ä–∞–∑–±–µ—Ä—ë–º –µ—ë –æ—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ—Å—Ç—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º.",
                "{topic} ‚Äî —ç—Ç–æ —Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∫–∞—Å–∞–µ—Ç—Å—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ –Ω–∞—Å. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –µ—ë –ø–æ–¥—Ä–æ–±–Ω–µ–µ.",
                "–í —ç—Ç–æ–π —Ä–∞–±–æ—Ç–µ –º—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–µ–º–µ ¬´{topic}¬ª. –ü–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è –æ–±—ä—è—Å–Ω–∏—Ç—å –≤—Å—ë –ø—Ä–æ—Å—Ç–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ."
            ],
            "school": [
                "–¢–µ–º–∞ ¬´{topic}¬ª –∏–∑—É—á–∞–µ—Ç—Å—è –≤ —à–∫–æ–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω–æ–π –¥–ª—è –æ–±—â–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è.",
                "{topic} ‚Äî –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è —Ç–µ–º–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏–∑—É—á–∞–µ–º –≤ —à–∫–æ–ª–µ. –î–∞–≤–∞–π—Ç–µ —É–∑–Ω–∞–µ–º –æ –Ω–µ–π –±–æ–ª—å—à–µ!",
                "–≠—Ç–∞ —Ä–∞–±–æ—Ç–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ —Ç–µ–º–µ ¬´{topic}¬ª. –ú—ã —É–∑–Ω–∞–µ–º –º–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ."
            ],
            "university": [
                "–í —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è —Ç–µ–º–∞ ¬´{topic}¬ª —Å –ø–æ–∑–∏—Ü–∏–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞—É—á–Ω–æ–π –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏.",
                "–ù–∞—Å—Ç–æ—è—â–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ—Å–≤—è—â–µ–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º—É –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—é —Ç–µ–º—ã ¬´{topic}¬ª.",
                "–¢–µ–º–∞ ¬´{topic}¬ª –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞—É–∫–∏."
            ]
        }
        
        self.conclusions = {
            "scientific": [
                "–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–º—ã ¬´{topic}¬ª –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥ –æ –µ—ë –º–Ω–æ–≥–æ–∞—Å–ø–µ–∫—Ç–Ω–æ—Å—Ç–∏ –∏ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏.",
                "–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥–∏, —Å–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ç–µ–º–∞ ¬´{topic}¬ª –∏–º–µ–µ—Ç –≤–∞–∂–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–∞–∫ –¥–ª—è —Ç–µ–æ—Ä–∏–∏, —Ç–∞–∫ –∏ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏.",
                "–í –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å, —á—Ç–æ –∏–∑—É—á–µ–Ω–∏–µ —Ç–µ–º—ã ¬´{topic}¬ª –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç—ã –¥–ª—è –Ω–∞—É—á–Ω–æ–≥–æ –ø–æ–∑–Ω–∞–Ω–∏—è."
            ],
            "simple": [
                "–í –∏—Ç–æ–≥–µ –º—ã —É–∑–Ω–∞–ª–∏ –º–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –æ —Ç–µ–º–µ ¬´{topic}¬ª. –ù–∞–¥–µ—é—Å—å, —ç—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –±—ã–ª–∞ –ø–æ–ª–µ–∑–Ω–æ–π.",
                "–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥, –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ç–µ–º–∞ ¬´{topic}¬ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–∞–∂–Ω–∞—è –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è.",
                "–ò—Ç–∞–∫, –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–ª–∏ —Ç–µ–º—É ¬´{topic}¬ª –∏ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å –≤ –µ—ë –æ—Å–Ω–æ–≤–Ω—ã—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö."
            ],
            "school": [
                "–ò–∑—É—á–∏–≤ —Ç–µ–º—É ¬´{topic}¬ª, –º—ã —É–∑–Ω–∞–ª–∏ –º–Ω–æ–≥–æ –Ω–æ–≤–æ–≥–æ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ.",
                "–í –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ç–µ–º–∞ ¬´{topic}¬ª –æ—á–µ–Ω—å –ø–æ–∑–Ω–∞–≤–∞—Ç–µ–ª—å–Ω–∞—è.",
                "–†–∞–±–æ—Ç–∞ –Ω–∞–¥ —Ç–µ–º–æ–π ¬´{topic}¬ª –±—ã–ª–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π. –¢–µ–ø–µ—Ä—å –º—ã –ª—É—á—à–µ –ø–æ–Ω–∏–º–∞–µ–º —ç—Ç—É —Ç–µ–º—É."
            ],
            "university": [
                "–†–µ–∑—é–º–∏—Ä—É—è –≤—ã—à–µ–∏–∑–ª–æ–∂–µ–Ω–Ω–æ–µ, —Å–ª–µ–¥—É–µ—Ç –∫–æ–Ω—Å—Ç–∞—Ç–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ —Ç–µ–º–∞ ¬´{topic}¬ª —Ç—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –º–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.",
                "–ü—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ç–µ–º—ã ¬´{topic}¬ª –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã.",
                "–í –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ç–µ–º—ã ¬´{topic}¬ª –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –µ—ë –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å."
            ]
        }
        
        self.content_blocks = {
            "scientific": [
                "–°–æ–≥–ª–∞—Å–Ω–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è–º, –¥–∞–Ω–Ω—ã–π –∞—Å–ø–µ–∫—Ç –∏–º–µ–µ—Ç –∫–ª—é—á–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –æ–±—â–µ–π –∫–∞—Ä—Ç–∏–Ω—ã.",
                "–ù–∞—É—á–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ —É–¥–µ–ª—è–µ—Ç –æ—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–º—É –≤–æ–ø—Ä–æ—Å—É, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –º–Ω–æ–≥–æ—á–∏—Å–ª–µ–Ω–Ω—ã–º–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏.",
                "–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.",
                "–≠–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤—É—é—Ç –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∫ –∏–∑—É—á–µ–Ω–∏—é.",
                "–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –±–∞–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –Ω–∞—É—á–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö."
            ],
            "simple": [
                "–≠—Ç–æ –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å.",
                "–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º—Å—è –≤ —ç—Ç–æ–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ, —á—Ç–æ–±—ã –≤—Å—ë —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–æ.",
                "–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.",
                "–ú–Ω–æ–≥–∏–µ –ª—é–¥–∏ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å —ç—Ç–∏–º –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏.",
                "–ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–æ–º–æ–∂–µ—Ç –ª—É—á—à–µ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–µ–º–µ."
            ],
            "school": [
                "–≠—Ç–æ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ –∑–Ω–∞—Ç—å –∫–∞–∂–¥–æ–º—É —à–∫–æ–ª—å–Ω–∏–∫—É.",
                "–£—á–∏—Ç–µ–ª—è —á–∞—Å—Ç–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç –æ–± —ç—Ç–æ–º –Ω–∞ —É—Ä–æ–∫–∞—Ö.",
                "–≠—Ç–∏ –∑–Ω–∞–Ω–∏—è –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º.",
                "–í —É—á–µ–±–Ω–∏–∫–∞—Ö –æ–± —ç—Ç–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ.",
                "–≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–µ–º."
            ],
            "university": [
                "–î–∞–Ω–Ω—ã–π –∞—Å–ø–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥–º–µ—Ç–æ–º –¥–∏—Å–∫—É—Å—Å–∏–π –≤ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–æ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ.",
                "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞.",
                "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏.",
                "–ú–µ–∂–¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞—Ä–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤.",
                "–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–ª–∞—Å—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–∞–ª–∏–¥–Ω—ã—Ö –º–µ—Ç–æ–¥–∏–∫."
            ]
        }
        
        self.subtopics = [
            "–ò—Å—Ç–æ—Ä–∏—è –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ",
            "–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è",
            "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ç–∏–ø–æ–ª–æ–≥–∏—è",
            "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã",
            "–§—É–Ω–∫—Ü–∏–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏–µ",
            "–ú–µ—Ç–æ–¥—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è",
            "–°–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ",
            "–ü—Ä–æ–±–ª–µ–º—ã –∏ –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã",
            "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ",
            "–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑"
        ]
        
        self.authors = [
            "–ò–≤–∞–Ω–æ–≤ –ò.–ò.", "–ü–µ—Ç—Ä–æ–≤ –ü.–ü.", "–°–∏–¥–æ—Ä–æ–≤–∞ –ê.–í.",
            "–ö–æ–∑–ª–æ–≤ –í.–ù.", "–ù–æ–≤–∏–∫–æ–≤–∞ –ï.–ú.", "–ú–æ—Ä–æ–∑–æ–≤ –î.–°."
        ]
        
        self.publishers = [
            "–ù–∞—É–∫–∞", "–ü—Ä–æ—Å–≤–µ—â–µ–Ω–∏–µ", "–í—ã—Å—à–∞—è —à–∫–æ–ª–∞", "–ê–∫–∞–¥–µ–º–∏—è", "–ü–∏—Ç–µ—Ä"
        ]
    
    def generate(self, mode: str, topic: str, volume: str, style: str, author_info: dict = None) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞"""
        
        generators = {
            "referat": self._generate_referat,
            "conspect": self._generate_conspect,
            "doklad": self._generate_doklad,
            "question": self._generate_answer,
            "retell": self._generate_retell,
            "essay": self._generate_essay,
        }
        
        generator_func = generators.get(mode, self._generate_referat)
        return generator_func(topic, volume, style, author_info)
    
    def _get_section_count(self, volume: str) -> int:
        """–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–¥–µ–ª–æ–≤"""
        return {"short": 2, "medium": 4, "long": 6, "very_long": 8}.get(volume, 4)
    
    def _generate_title_page(self, topic: str, author_info: dict, work_type: str) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏—Ç—É–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã"""
        
        if not author_info or not author_info.get('include_title'):
            return ""
        
        edu_type = author_info.get('edu_type', '–°—Ç—É–¥–µ–Ω—Ç')
        grade = author_info.get('grade', '1')
        name = author_info.get('name', '[–§–ò–û –∞–≤—Ç–æ—Ä–∞]')
        institution = author_info.get('institution', '[–£—á–µ–±–Ω–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ]')
        group = author_info.get('group', '')
        teacher = author_info.get('teacher', '')
        
        if edu_type == "–£—á–µ–Ω–∏–∫":
            grade_text = f"{grade} –∫–ª–∞—Å—Å–∞"
        else:
            grade_text = f"{grade} –∫—É—Ä—Å–∞"
        
        lines = [
            "=" * 60,
            "",
            institution.upper() if institution else "[–£–ß–ï–ë–ù–û–ï –ó–ê–í–ï–î–ï–ù–ò–ï]",
            "",
            "-" * 60,
            "",
            work_type,
            "",
            "–Ω–∞ —Ç–µ–º—É:",
            f"¬´{topic}¬ª",
            "",
            "-" * 60,
            "",
            "–í—ã–ø–æ–ª–Ω–∏–ª(–∞):",
            f"{edu_type} {grade_text}",
            name if name else "[–§–ò–û]",
        ]
        
        if group:
            lines.append(f"–ì—Ä—É–ø–ø–∞: {group}")
        
        if teacher:
            lines.append("")
            lines.append(f"–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å: {teacher}")
        
        year = datetime.now().year
        lines.extend([
            "",
            "-" * 60,
            "",
            f"{year} –≥–æ–¥",
            "",
            "=" * 60,
            "",
            ""
        ])
        
        return "\n".join(lines)
    
    def _generate_referat(self, topic: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞—Ç–∞"""
        
        sections = self._get_section_count(volume)
        result = []
        
        # –¢–∏—Ç—É–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        title_page = self._generate_title_page(topic, author_info, "–†–ï–§–ï–†–ê–¢")
        if title_page:
            result.append(title_page)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        result.append("# –†–ï–§–ï–†–ê–¢")
        result.append(f"## –¢–µ–º–∞: {topic}\n")
        result.append("---\n")
        
        # –í–≤–µ–¥–µ–Ω–∏–µ
        result.append("## –í–í–ï–î–ï–ù–ò–ï\n")
        intro = random.choice(self.introductions.get(style, self.introductions["scientific"]))
        result.append(intro.format(topic=topic))
        result.append("")
        
        # –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å
        result.append("## –û–°–ù–û–í–ù–ê–Ø –ß–ê–°–¢–¨\n")
        
        subtopics = random.sample(self.subtopics, min(sections, len(self.subtopics)))
        for i, subtopic in enumerate(subtopics, 1):
            result.append(f"### {i}. {subtopic}\n")
            
            content = self.content_blocks.get(style, self.content_blocks["scientific"])
            paragraphs = {"short": 2, "medium": 3, "long": 4, "very_long": 5}.get(volume, 3)
            
            for _ in range(paragraphs):
                paragraph = " ".join(random.sample(content, min(3, len(content))))
                result.append(paragraph)
                result.append("")
        
        # –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
        result.append("## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï\n")
        conclusion = random.choice(self.conclusions.get(style, self.conclusions["scientific"]))
        result.append(conclusion.format(topic=topic))
        result.append("")
        
        # –°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã
        result.append("## –°–ü–ò–°–û–ö –õ–ò–¢–ï–†–ê–¢–£–†–´\n")
        for i in range(5):
            author = random.choice(self.authors)
            publisher = random.choice(self.publishers)
            year = random.randint(2018, 2024)
            result.append(f"{i+1}. {author} {topic}. ‚Äî –ú.: {publisher}, {year}.")
        
        return "\n".join(result)
    
    def _generate_conspect(self, topic: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Å–ø–µ–∫—Ç–∞"""
        
        result = []
        result.append(f"# üìù –ö–û–ù–°–ü–ï–ö–¢: {topic}\n")
        result.append("---\n")
        
        # –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è
        result.append("## üîë –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è\n")
        terms = [
            ("–û–±—ä–µ–∫—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", f"–ø—Ä–µ–¥–º–µ—Ç –∏–∑—É—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ {topic}"),
            ("–ü—Ä–µ–¥–º–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", f"–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∞—Å–ø–µ–∫—Ç—ã {topic}"),
            ("–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è", "—Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –º–µ—Ç–æ–¥–æ–≤ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"),
            ("–ö–æ–Ω—Ü–µ–ø—Ü–∏—è", f"—Å–∏—Å—Ç–µ–º–∞ –≤–∑–≥–ª—è–¥–æ–≤ –Ω–∞ {topic}"),
        ]
        for term, definition in terms:
            result.append(f"**{term}** ‚Äî {definition}\n")
        result.append("")
        
        # –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–∑–∏—Å—ã
        result.append("## üìå –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–∑–∏—Å—ã\n")
        theses_count = {"short": 3, "medium": 5, "long": 7, "very_long": 10}.get(volume, 5)
        for i in range(theses_count):
            result.append(f"{i+1}. –¢–µ–∑–∏—Å –æ {topic.lower()}")
        result.append("")
        
        # –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
        result.append("## üìñ –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ\n")
        sections = random.sample(self.subtopics, min(4, len(self.subtopics)))
        content = self.content_blocks.get(style, self.content_blocks["scientific"])
        
        for section in sections:
            result.append(f"### ‚ñ∏ {section}\n")
            for _ in range(3):
                result.append(f"‚Ä¢ {random.choice(content)}")
            result.append("")
        
        # –í—ã–≤–æ–¥—ã
        result.append("## ‚úÖ –í—ã–≤–æ–¥—ã\n")
        result.append(f"‚Üí {topic} ‚Äî –≤–∞–∂–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è")
        result.append("‚Üí –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–º—ã –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ")
        result.append("‚Üí –¢–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏–∑—É—á–µ–Ω–∏—è")
        
        return "\n".join(result)
    
    def _generate_doklad(self, topic: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–ª–∞–Ω–∞ –¥–æ–∫–ª–∞–¥–∞"""
        
        result = []
        
        # –¢–∏—Ç—É–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        title_page = self._generate_title_page(topic, author_info, "–ü–õ–ê–ù –î–û–ö–õ–ê–î–ê")
        if title_page:
            result.append(title_page)
        
        result.append(f"# üìä –ü–õ–ê–ù –î–û–ö–õ–ê–î–ê")
        result.append(f"## –¢–µ–º–∞: {topic}\n")
        result.append("---\n")
        
        time_map = {
            "short": "5-7 –º–∏–Ω—É—Ç",
            "medium": "10-15 –º–∏–Ω—É—Ç",
            "long": "20-25 –º–∏–Ω—É—Ç",
            "very_long": "30-40 –º–∏–Ω—É—Ç"
        }
        result.append(f"**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ –≤—Ä–µ–º—è:** {time_map.get(volume, '10-15 –º–∏–Ω—É—Ç')}\n")
        
        # –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ
        result.append("### 1Ô∏è‚É£ –í–°–¢–£–ü–õ–ï–ù–ò–ï (1-2 –º–∏–Ω)\n")
        result.append("**–¶–µ–ª—å:** –ü—Ä–∏–≤–ª–µ—á—å –≤–Ω–∏–º–∞–Ω–∏–µ –∞—É–¥–∏—Ç–æ—Ä–∏–∏\n")
        result.append(f"‚Ä¢ –ù–∞—á–Ω–∏—Ç–µ —Å –≤–æ–ø—Ä–æ—Å–∞ –æ {topic}")
        result.append("‚Ä¢ –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π —Ñ–∞–∫—Ç")
        result.append("‚Ä¢ –û–±–æ–∑–Ω–∞—á—å—Ç–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–º—ã")
        result.append("")
        
        # –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å
        result.append("### 2Ô∏è‚É£ –û–°–ù–û–í–ù–ê–Ø –ß–ê–°–¢–¨\n")
        sections = random.sample(self.subtopics, self._get_section_count(volume))
        for i, section in enumerate(sections, 1):
            result.append(f"\n**–ü—É–Ω–∫—Ç {i}: {section}**")
            result.append("   ‚ó¶ –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ–∑–∏—Å")
            result.append("   ‚ó¶ –ü—Ä–∏–º–µ—Ä –∏–ª–∏ —Ñ–∞–∫—Ç")
            result.append("   ‚ó¶ –í—ã–≤–æ–¥ –ø–æ –ø—É–Ω–∫—Ç—É")
        result.append("")
        
        # –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
        result.append("### 3Ô∏è‚É£ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï (1-2 –º–∏–Ω)\n")
        result.append("‚Ä¢ –ü–æ–¥–≤–µ–¥–∏—Ç–µ –∏—Ç–æ–≥–∏")
        result.append("‚Ä¢ –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –≥–ª–∞–≤–Ω—ã–µ –º—ã—Å–ª–∏")
        result.append("‚Ä¢ –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã")
        result.append("")
        
        # –°–æ–≤–µ—Ç—ã
        result.append("### üí° –°–û–í–ï–¢–´ –î–õ–Ø –í–´–°–¢–£–ü–õ–ï–ù–ò–Ø\n")
        tips = [
            "–ì–æ–≤–æ—Ä–∏—Ç–µ —É–≤–µ—Ä–µ–Ω–Ω–æ –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –∞—É–¥–∏—Ç–æ—Ä–∏—é",
            "–ù–µ —á–∏—Ç–∞–π—Ç–µ —Ç–µ–∫—Å—Ç ‚Äî —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–π—Ç–µ —Å–≤–æ–∏–º–∏ —Å–ª–æ–≤–∞–º–∏",
            "–î–µ–ª–∞–π—Ç–µ –ø–∞—É–∑—ã –º–µ–∂–¥—É –≤–∞–∂–Ω—ã–º–∏ –º—ã—Å–ª—è–º–∏",
            "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –∂–∏–∑–Ω–∏",
            "–°–ª–µ–¥–∏—Ç–µ –∑–∞ –≤—Ä–µ–º–µ–Ω–µ–º"
        ]
        for tip in tips:
            result.append(f"‚úì {tip}")
        
        return "\n".join(result)
    
    def _generate_answer(self, question: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å"""
        
        result = []
        result.append(f"# ‚ùì –í–û–ü–†–û–°:")
        result.append(f"*{question}*\n")
        result.append("---\n")
        result.append("# ‚úÖ –û–¢–í–ï–¢:\n")
        
        # –ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç
        result.append("## üìå –ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç\n")
        intro = random.choice(self.introductions.get(style, self.introductions["simple"]))
        result.append(intro.format(topic=question))
        result.append("")
        
        # –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç
        result.append("## üìñ –†–∞–∑–≤—ë—Ä–Ω—É—Ç—ã–π –æ—Ç–≤–µ—Ç\n")
        content = self.content_blocks.get(style, self.content_blocks["scientific"])
        paragraphs = {"short": 2, "medium": 4, "long": 6, "very_long": 8}.get(volume, 4)
        
        for _ in range(paragraphs):
            paragraph = " ".join(random.sample(content, min(3, len(content))))
            result.append(paragraph)
            result.append("")
        
        # –ü—Ä–∏–º–µ—Ä—ã
        result.append("## üìù –ü—Ä–∏–º–µ—Ä—ã\n")
        result.append("1. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä –ø–æ —Ç–µ–º–µ")
        result.append("2. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è")
        result.append("3. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π")
        result.append("")
        
        # –í—ã–≤–æ–¥
        result.append("## üéØ –í—ã–≤–æ–¥\n")
        conclusion = random.choice(self.conclusions.get(style, self.conclusions["simple"]))
        result.append(conclusion.format(topic=question))
        
        return "\n".join(result)
    
    def _generate_retell(self, text: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä–µ—Å–∫–∞–∑–∞"""
        
        result = []
        result.append("# üìñ –ü–ï–†–ï–°–ö–ê–ó –¢–ï–ö–°–¢–ê\n")
        result.append("---\n")
        
        words = text.split()
        word_count = len(words)
        result.append(f"**–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:** {word_count} —Å–ª–æ–≤\n")
        
        # –ö—Ä–∞—Ç–∫–∏–π –ø–µ—Ä–µ—Å–∫–∞–∑
        result.append("## üìå –ö—Ä–∞—Ç–∫–∏–π –ø–µ—Ä–µ—Å–∫–∞–∑\n")
        ratio = {"short": 0.2, "medium": 0.4, "long": 0.6, "very_long": 0.8}.get(volume, 0.4)
        summary_length = max(20, int(word_count * ratio))
        
        if word_count > 20:
            summary = " ".join(words[:summary_length]) + "..."
        else:
            summary = text
        result.append(summary)
        result.append("")
        
        # –û—Å–Ω–æ–≤–Ω—ã–µ –º—ã—Å–ª–∏
        result.append("## üí° –û—Å–Ω–æ–≤–Ω—ã–µ –º—ã—Å–ª–∏\n")
        result.append("1. –ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è —Ç–µ–∫—Å—Ç–∞")
        result.append("2. –ö–ª—é—á–µ–≤—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ—Ä–∞")
        result.append("3. –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã")
        result.append("")
        
        # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
        result.append("## üîë –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞\n")
        keywords = [w for w in words if len(w) > 5][:10]
        if keywords:
            result.append(", ".join(set(keywords)))
        else:
            result.append("(–∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞)")
        
        return "\n".join(result)
    
    def _generate_essay(self, topic: str, volume: str, style: str, author_info: dict) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —ç—Å—Å–µ"""
        
        result = []
        
        # –¢–∏—Ç—É–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
        title_page = self._generate_title_page(topic, author_info, "–≠–°–°–ï")
        if title_page:
            result.append(title_page)
        
        result.append(f"# ‚úçÔ∏è –≠–°–°–ï")
        result.append(f"## {topic}\n")
        result.append("---\n")
        
        # –≠–ø–∏–≥—Ä–∞—Ñ
        epigraphs = [
            "¬´–ó–Ω–∞–Ω–∏–µ ‚Äî —Å–∏–ª–∞¬ª ‚Äî –§—Ä—ç–Ω—Å–∏—Å –ë—ç–∫–æ–Ω",
            "¬´–£—á–∏—Ç—å—Å—è, —É—á–∏—Ç—å—Å—è –∏ –µ—â—ë —Ä–∞–∑ —É—á–∏—Ç—å—Å—è¬ª",
            "¬´–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ‚Äî –ª—É—á—à–∏–π –¥—Ä—É–≥¬ª ‚Äî –ê—Ä–∏—Å—Ç–æ—Ç–µ–ª—å"
        ]
        result.append(f"*{random.choice(epigraphs)}*\n")
        
        # –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ
        result.append("## –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ\n")
        intro = random.choice(self.introductions.get(style, self.introductions["simple"]))
        result.append(intro.format(topic=topic))
        result.append("")
        
        # –û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å
        result.append("## –†–∞–∑–º—ã—à–ª–µ–Ω–∏—è\n")
        paragraphs = {"short": 2, "medium": 3, "long": 4, "very_long": 5}.get(volume, 3)
        content = self.content_blocks.get(style, self.content_blocks["scientific"])
        
        for _ in range(paragraphs):
            paragraph = " ".join(random.sample(content, min(4, len(content))))
            result.append(paragraph)
            result.append("")
        
        # –ó–∞–∫–ª—é—á–µ–Ω–∏–µ
        result.append("## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ\n")
        conclusion = random.choice(self.conclusions.get(style, self.conclusions["simple"]))
        result.append(conclusion.format(topic=topic))
        
        return "\n".join(result)